<!DOCTYPE html>
<html lang="zh-hant">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>首頁</title>
        <!-- link -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">
        <link rel="stylesheet" href="./css/index.css">
        <!-- script -->
        <script src="https://pardnchiu.github.io/PDExtension-js/v3/PDExtension.min.js" copyright="Pardn Ltd" defer></script>
        <!-- inline-style -->
        <style>
            .dom-temp {
                display: none !important;
            }
        </style>
    </head>

    <body id="body">
        <!-- 登入 -->
        <section class="login dom-temp" :if="is_guest">
            <h1>{{ login.title }}</h1>
            <section>
                <label>
                    <input type="password" placeholder="API Key" :model="key">
                </label>
                <i class="fa-solid fa-eye-slash" @click="show"></i>
            </section>
            <button @click="login">
                前往
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </section>
        <section class="dom-temp" :else>
            <nav class="body-top">
                <section>
                    <section class="left">
                        <a href="/">
                            <img src="./image/logo_ffffff.svg" alt="">
                            <strong>{{ title }}</strong>
                        </a>
                    </section>
                    <section class="right">
                        <button class="df" @click="logout">登出</button>
                    </section>
                </section>
            </nav>
            <section>
                <section class="body-left">
                    <div :for="e in left_tab">
                        <p @click="tab_show">
                            <i :class="e.icon"></i>
                            <span>{{ e.title }}</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </p>
                        <section :data-row="LENGTH(e.body)">
                            <a :href="a.href" :data-selected="a.is_selected" :for="a in e.body">
                                <i :class="a.icon"></i>
                                <span>{{ a.title }}</span>
                            </a>
                        </section>
                    </div>
                </section>
                <section class="body-right">
                    <nav>
                        <button>
                            <i class="fa-solid fa-bars"></i>
                        </button>
                        <a href="/">首頁</a>
                    </nav>
                    <p class="hint"><i class="fa-solid fa-arrow-left"></i>點擊左方選單以瀏覽內容</p>
                </section>
            </section>
        </section>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const page = new $dom({
                    id: "body",
                    data: {
                        is_guest: false,
                        login: {
                            title: "LOGIN",
                            email: "",
                            password: "",
                        },
                        title: "管理後台",
                        left_tab: [
                            {
                                icon: "fa-solid fa-newspaper",
                                title: "文章管理",
                                body: [
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-table-list",
                                        title: "文章列表",
                                        href: "/article-list.html"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-pen",
                                        title: "撰寫文章",
                                        href: "/article-add.html"
                                    },
                                ]
                            },
                            {
                                icon: "fa-solid fa-folder-open",
                                title: "檔案管理",
                                body: [
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-photo-film",
                                        title: "媒體庫",
                                        href: "/photo-library.html"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-file",
                                        title: "robots.txt",
                                        href: "/file-edit.html"
                                    },
                                ]
                            },
                            {
                                icon: "fa-solid fa-tv",
                                title: "網站管理",
                                body: [
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-file",
                                        title: "首頁"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-file",
                                        title: "介紹頁"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-file",
                                        title: "聯絡我們"
                                    },
                                ]
                            },
                            {
                                icon: "fa-solid fa-user-shield",
                                title: "系統管理",
                                body: [
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-mail-bulk",
                                        title: "信箱設定"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-unlock-alt",
                                        title: "更改密碼"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-key",
                                        title: "兩步驟驗證"
                                    },
                                ]
                            },
                            {
                                icon: "fa-solid fa-code-branch",
                                title: "版本資訊",
                                body: [
                                    {
                                        is_selected: false,
                                        icon: "fa-brands fa-readme",
                                        title: "Readme"
                                    },
                                    {
                                        is_selected: false,
                                        icon: "fa-solid fa-balance-scale",
                                        title: "License"
                                    },
                                ]
                            }
                        ]
                    },
                    event: {
                        init: function () {
                            // if ("section.body-left".$) {
                            //     "section.body-left".$.$childAll.forEach(e => {
                            //         e._class("r" + e.$child(-1).$childAll.length)
                            //     });
                            // };
                        },
                        show: function () {
                            const isShow = this.$parent(0).$$class("show");
                            this.__class(`fa-solid ${isShow ? "fa-eye-slash" : "fa-eye"}`);
                            this.$pre(0).$child(0).type = isShow ? "password" : "text";
                            this.$parent(0).$$class_(isShow, "show");
                        },
                        login: function () {
                            page.dom.$child(0)._class("show");

                            setTimeout(() => {
                                page.data.is_guest = false;

                                setTimeout(_ => {
                                    page.event.init();
                                }, 100);
                            }, 1000);
                        },
                        logout: function () {
                            page.data.is_guest = true;
                        },
                        tab_show: function (e) {
                            const parent = this.$parent(0);
                            const is_show = parent.$$class("show") || parent.$sel("a[data-selected='true']");
                            const is_hide = parent.$$class("hide");

                            if (is_hide) {
                                parent._class("show").class_("hide");
                            }
                            else if (is_show) {
                                parent._class("hide").class_("show");
                            }
                            else {
                                parent._class("show");
                            }

                        }
                    },
                    next: () => {
                        page.event.init();
                        // const url = new URL(location.href);

                        // login.data.email = url.searchParams.get("user_email");
                        // history.replaceState(null, null, "/management/login");
                    }
                });
            });
        </script>
    </body>

</html>